/*! ingress-model-viewer 04-02-2015 */

!function(a,b){"use strict";var c={};if(!JavaDeserializer||!glMatrix||!libtga)throw"Missing dependencies";var d=window.console||{log:function(){},warn:function(){},info:function(){}};!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var e={teamColors:{RESISTANCE:vec4.fromValues(0,.7607843137254902,1,1),ENLIGHTENED:vec4.fromValues(.1568627450980392,.9568627450980393,.1568627450980392,1),NEUTRAL:vec4.fromValues(.9764705882352941,.9764705882352941,.9764705882352941,1),LOKI:vec4.fromValues(1,.1568627450980392,.1568627450980392,1)},qualityColors:{EXTREMELY_RARE:vec4.fromValues(.9803921568627451,.39215686274509803,.39215686274509803,1),VERY_RARE:vec4.fromValues(.9568627450980393,.5215686274509804,.9254901960784314,1),MORE_RARE:vec4.fromValues(.7647058823529411,0,1,1),RARE:vec4.fromValues(.6666666666666666,.5372549019607843,.984313725490196,1),LESS_COMMON:vec4.fromValues(.45098039215686275,.6588235294117647,1,1),COMMON:vec4.fromValues(.5098039215686274,.9529411764705882,.7058823529411765,1),VERY_COMMON:vec4.fromValues(.6980392156862745,.6980392156862745,.6980392156862745,1),L1:vec4.fromValues(.996078431372549,.807843137254902,.35294117647058826,1),L2:vec4.fromValues(1,.6509803921568628,.18823529411764706,1),L3:vec4.fromValues(1,.45098039215686275,.08235294117647059,1),L4:vec4.fromValues(.8941176470588236,0,0,1),L5:vec4.fromValues(.9921568627450981,.1607843137254902,.5725490196078431,1),L6:vec4.fromValues(.9215686274509803,.14901960784313725,.803921568627451,1),L7:vec4.fromValues(.7568627450980392,.1411764705882353,.8784313725490196,1),L8:vec4.fromValues(.5882352941176471,.15294117647058825,.9568627450980393,1)},anomalyColors:{1:vec4.fromValues(1,.5686274509803921,.21176470588235294,1),2:vec4.fromValues(1,.3215686274509804,.9058823529411765,1),3:vec4.fromValues(.6196078431372549,.35294117647058826,1,1),4:vec4.fromValues(.8431372549019608,.27058823529411763,.27058823529411763,1),5:vec4.fromValues(1,.9450980392156862,0,1),6:vec4.fromValues(.6509803921568628,1,.9019607843137255,1),7:vec4.fromValues(.5725490196078431,.5803921568627451,.592156862745098,1)},artifactColors:{Helios:{RedGlow:vec4.fromValues(.92,.51,.14,1),PurpleGlow:vec4.fromValues(1,.87,.55,1),TargetGlow:vec4.fromValues(1,.72,0,1)},Amar:{TargetGlow:vec4.fromValues(.62,.22,.62,1),RedGlow:vec4.fromValues(.79,.11,.49,1),PurpleGlow:vec4.fromValues(.58,.17,1,1)},Jarvis:{TargetGlow:vec4.fromValues(.62,.22,.62,1),RedGlow:vec4.fromValues(.79,.11,.49,1),PurpleGlow:vec4.fromValues(.58,.17,1,1)}},xmColors:{coreGlow:vec4.fromValues(.92,.7,.89,1),coreGlowAlt:vec4.fromValues(.6,.4,.6,.8)}};c.Constants=e;var f=function(a,b){function c(){}c.prototype=b.prototype,a.superClass_=b.prototype,a.prototype=new c,a.prototype.constructor=a};c.Utilities=c.Utilities||{},c.Utilities.inherits=f;var g=function(a,b,c){if("image"===b||"image.co"===b)if(/\.tga$/.test(a))libtga.loadFile(a,function(a,b){if(a)return void c(a,null);var d=document.createElement("canvas"),e=d.getContext("2d"),f=e.createImageData(b.width,b.height);f.data.set(b.imageData),d.height=b.height,d.width=b.width,e.putImageData(f,0,0);var g=new Image;g.onload=function(){c(null,this)},g.onerror=function(a){c(a,null)},g.src=d.toDataURL()});else{var d=new Image;"image.co"===b&&(d.crossOrigin="anoymous"),d.onload=function(){c(null,this)},d.onerror=function(a){c(a,null)},d.src=a}else{var e=new XMLHttpRequest;e.open("GET",a),e.responseType=b,e.onload=function(){c(null,this.response)},e.onerror=function(a){c(a,null)},e.send()}},h=function(){var a={},c={};this.loadAsset=function(b,d,e){var f="_"+encodeURIComponent(b);return c[f]?void e(null,c[f]):(a[f]=a[f]||[],a[f].push(e),void(c.hasOwnProperty(f)||(c[f]=!1,g(b,d,function(b,d){b||(c[f]=d);for(var e;e=a[f].shift();)e(b,d)}))))},this.loadAssetGroup=function(a,c,d){if(a.length!==c.length)throw"Incompatible types: types.length = "+c.length+"; urls.length = "+a.length;for(var e=a.length,f=new Array(e),g=function(a,b,c){if(b)return void d(b,null);f[a]=c;var g,h=!0;for(g=0;e>g;g++)h=h&&f[g];h&&d(null,f)},h=0;h<a.length;h++)this.loadAsset(a[h],c[h],g.bind(b,h))},this.getAsset=function(a){return c[a]}};c.AssetLoader=h,c.Utilities=c.Utilities||{},c.Utilities.loadResource=g;var i=function(a){this._gl=a};c.GLBound=i;var j=function(a,b,c){i.call(this,a),this.info=b;var d={MipMapLinearLinear:a.LINEAR_MIPMAP_LINEAR,Linear:a.LINEAR,MipMapLinearNearest:a.LINEAR_MIPMAP_NEAREST,MipMapNearestLinear:a.NEAREST_MIPMAP_LINEAR,Repeat:a.REPEAT,ClampToEdge:a.CLAMP_TO_EDGE},e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d[b.minFilter]),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d[b.magFilter]),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,d[b.wrapS]),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,d[b.wrapT]),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c),/MipMap/.test(b.minFilter)&&a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null),this.texture=e};j.prototype.use=function(a){var b=this._gl;a=a||0,b.bindTexture(b.TEXTURE_2D,this.texture),b.activeTexture(b.TEXTURE0+a)},c.Texture=j;var k=function(a,b){this.name=a,this.size=b};c.VertexAttribute=k;var l=function(a,b,c){i.call(this,a),this.attributes=b,this.values=c,this.glBuf=this.size=this.count=null};f(l,i),l.prototype.init=function(){var a=this._gl;this.glBuf=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.glBuf),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.values),a.STATIC_DRAW),this.size=0;for(var b,c=0,e=0;e<this.attributes.length;e++)b=this.attributes[e],this.size+=4*b.size,c+=b.size;this.values.length%c!==0&&d.warn("values array length is not an even multiple of the total size of the attributes"),this.count=Math.floor(this.values.length/c)},l.prototype.draw=function(a){var b,c=this._gl,d=0;this.glBuf||this.init(),c.bindBuffer(c.ARRAY_BUFFER,this.glBuf);for(var e=0;e<this.attributes.length;e++)b=this.attributes[e],b.name in a&&(c.enableVertexAttribArray(a[b.name]),c.vertexAttribPointer(a[b.name],b.size,c.FLOAT,!1,this.size,d),d+=4*b.size)},c.AttributeBuffer=l;var m=function(a,b,c,d){i.call(this,a),this.attributes=new l(a,c,b),this.faces=d,this.indexBuf=null};f(m,i),m.prototype.init=function(){var a=this._gl;this.attributes.init(),this.indexBuf=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuf),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.faces),a.STATIC_DRAW)},m.prototype.draw=function(a){var b=this._gl;this.indexBuf||this.init(),this.attributes.draw(a),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuf),b.drawElements(b.TRIANGLES,this.faces.length,b.UNSIGNED_SHORT,0)},c.Mesh=m;var n=function(){var a=function(a){var b,c,e,f,g,h=new DataView(a),i=0,j=h.getUint32(i);i+=4;for(var l=[],m=0;j>m;m++){for(b=h.getUint32(i),1!=b&&16!=b&&d.warn("unknown type "+b),i+=4,c=h.getUint32(i),i+=4,e=h.getUint16(i),i+=2,g="",f=0;e>f;f++)g+=String.fromCharCode(h.getUint8(i+f));i+=e,l.push(new k(g,c))}return l},b=function(b,c){var d=new JavaDeserializer(c),e=d.getStream(),f=e.getContents(),g=f[0].contents.toArray(),h=f[3].contents.toArray(),i=a(h),j=f[1].contents.toArray();m.call(this,b,g,i,j)};return f(b,m),b}(),o=function(){var a=function(a){if(/precision mediump float/g.test(a))return a;var b=a.split("\n");return b.splice(1,0,"#ifdef GL_ES","precision mediump float;","#endif"),b.join("\n")},b=function(a,b,c,d){var e,f,g=c.name,h=a.getUniformLocation(b,g),i=c.type,j=!1,k=!0;if(c.size>1&&d)switch(i){case a.FLOAT:e=a.uniform1fv,f=Float32Array,k=!1;break;case a.INT:case a.BOOL:case a.SAMPLER_2D:case a.SAMPLER_CUBE:e=a.uniform1iv,f=Uint16Array,k=!1}if(k)switch(i){case a.FLOAT:e=a.uniform1f;break;case a.FLOAT_VEC2:e=a.uniform2fv,f=d?Float32Array:new Float32Array(2);break;case a.FLOAT_VEC3:e=a.uniform3fv,f=d?Float32Array:new Float32Array(3);break;case a.FLOAT_VEC4:e=a.uniform4fv,f=d?Float32Array:new Float32Array(4);break;case a.INT:case a.BOOL:case a.SAMPLER_2D:case a.SAMPLER_CUBE:e=a.uniform1i;break;case a.INT_VEC2:case a.BOOL_VEC2:e=a.uniform2iv,f=d?Uint16Array:new Uint16Array(2);break;case a.INT_VEC3:case a.BOOL_VEC3:e=a.uniform3iv,f=d?Uint16Array:new Uint16Array(3);break;case a.INT_VEC4:case a.BOOL_VEC4:e=a.uniform4iv,f=d?Uint16Array:new Uint16Array(4);break;case a.FLOAT_MAT2:j=!0,e=a.uniformMatrix2fv;break;case a.FLOAT_MAT3:j=!0,e=a.uniformMatrix3fv;break;case a.FLOAT_MAT4:j=!0,e=a.uniformMatrix4fv}if(e.bind)e=e.bind(a);else{var l=e;e=function(){l.apply(a,arguments)}}return d&&f?function(a){e(h,new f(a))}:j?function(a){e(h,!1,a)}:f?function(a){f.set(a.toFloat32Array?a.toFloat32Array():a),e(h,f)}:function(a){e(h,a)}},c=function(b,c,d){i.call(this,b),this.program=null,this.vertexSource=a(c),this.fragmentSource=d,this.attributes={},this.uniforms={}};return f(c,i),c.prototype.setupLocations=function(){for(var a,c,d=this._gl,e=this.program,f=d.getProgramParameter(e,d.ACTIVE_ATTRIBUTES),g=0;f>g;g++)a=d.getActiveAttrib(e,g),this.attributes[a.name]=d.getAttribLocation(e,a.name);for(f=d.getProgramParameter(e,d.ACTIVE_UNIFORMS),g=0;f>g;g++)a=d.getActiveUniform(e,g),c=a.name,c="]"==c[c.length-1]?c.substr(0,c.length-3):c,this.uniforms[c]=b(d,e,a,a.name!=c)},c.prototype.init=function(){var a,b,c=this._gl;if(a=c.createShader(c.VERTEX_SHADER),c.shaderSource(a,this.vertexSource),c.compileShader(a),!c.getShaderParameter(a,c.COMPILE_STATUS))throw d.warn(c.getShaderInfoLog(a)),d.error("could not compile vertex shader: "+this.vertexSource),"Vertex shader compile error!";if(b=c.createShader(c.FRAGMENT_SHADER),c.shaderSource(b,this.fragmentSource),c.compileShader(b),!c.getShaderParameter(b,c.COMPILE_STATUS))throw d.warn(c.getShaderInfoLog(b)),d.error("could not compile fragment shader: "+this.fragmentSource),"Fragment shader compile error!";if(this.program=c.createProgram(),c.attachShader(this.program,a),c.attachShader(this.program,b),c.linkProgram(this.program),!c.getProgramParameter(this.program,c.LINK_STATUS))throw"Could not link program";c.useProgram(this.program),this.setupLocations()},c.prototype.use=function(a){var b=this._gl;this.program?b.useProgram(this.program):this.init(),a(this.attributes,this.uniforms)},c}();c.Program=o;var p=function(){var a=function(a,b,c){o.call(this,a,b,c)};return f(a,o),a.prototype.use=function(a){this.program||this.init();var b=this._gl;b.useProgram(this.program),b.enable(b.DEPTH_TEST),b.enable(b.CULL_FACE),b.frontFace(b.CCW),b.cullFace(b.BACK),b.depthMask(!0),a(this.attributes,this.uniforms)},a}();c.Programs=c.Programs||{},c.Programs.Opaque=p;var q=function(){var a=function(a,b,c){o.call(this,a,b,c)};return f(a,o),a.prototype.use=function(a){this.program||this.init();var b=this._gl;b.useProgram(this.program),b.disable(b.CULL_FACE),b.enable(b.BLEND),b.depthMask(!1),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.SRC_ALPHA,b.ONE),a(this.attributes,this.uniforms)},a}();c.Programs=c.Programs||{},c.Programs.Glowramp=q;var r=function(){var a=function(a,b){for(var c in this.uniforms)this.uniforms.hasOwnProperty(c)&&c in b&&b[c](this.uniforms[c]);this.mesh.draw(a)},b=function(a,b){this.program=a,this.mesh=b,this.uniforms={},this.elapsed=0};return b.prototype.draw=function(){this.program.use(a.bind(this))},b.prototype.setUniform=function(a,b){this.uniforms[a]=b},b.prototype.updateTime=function(a){return this.elapsed+=a,this.onUpdate?this.onUpdate(a,this.elapsed):!0},b}();c.MeshDrawable=r;var s=function(){var a=function(a,b){r.call(this,a,b),this.viewProject=mat4.create(),this.model=mat4.create()};return f(a,r),a.prototype.updateMatrix=function(){var a=mat4.create();mat4.multiply(a,this.viewProject,this.model),this.uniforms.u_modelViewProject=a},a.prototype.updateView=function(a){this.viewProject=a,this.updateMatrix()},a.prototype.setMatrix=function(a){this.model=a,this.updateMatrix()},a}();c.Drawables=c.Drawables||{},c.Drawables.Model=s;var t=function(a,b,c){s.call(this,a,b),this.texture=c};f(t,s),t.prototype.draw=function(){this.texture.use(0),this.uniforms.u_texture=0,s.prototype.draw.call(this)},c.Drawables=c.Drawables||{},c.Drawables.Textured=t;var u=function(){var a=vec4.clone(e.qualityColors.VERY_RARE),b=vec4.clone(e.xmColors.coreGlow),c=function(c,d,e,f,g){t.call(this,c,d,e),this.uniforms.u_color0=f||vec4.clone(a),this.uniforms.u_color1=g||vec4.clone(b)};return f(c,t),c.prototype.setPrimaryColor=function(a){this.uniforms.u_color0=a},c.prototype.setSecondaryColor=function(a){this.uniforms.u_color1=a},c}();c.Drawables=c.Drawables||{},c.Drawables.Bicolored=u;var v=function(){var a=vec4.clone(c.Constants.teamColors.NEUTRAL),b=function(b,c,d,e,f,g,h){t.call(this,b,c,d),this.uniforms.u_baseColor=vec4.clone(a),this.uniforms.u_rotation=f||0,this.uniforms.u_rampTarget=g||0,this.uniforms.u_alpha=h||.6};return f(b,t),b.prototype.setBaseColor=function(a){this.uniforms.u_baseColor=a},b.prototype.setAlpha=function(a){this.uniforms.u_alpha=a},b.prototype.updateTime=function(a){var b=s.prototype.updateTime.call(this,a),c=this.elapsed/5e3;return this.uniforms.u_rotation=c,this.uniforms.u_rampTarget=Math.sin(Math.PI/2*(c-Math.floor(c))),this.uniforms.u_alpha=.05*Math.sin(c)+.75,b},b}();c.Drawables=c.Drawables||{},c.Drawables.Glowramp=v;var w=function(){var a=vec4.clone(e.xmColors.coreGlow),b=vec4.clone(e.xmColors.coreGlowAlt),c=function(c,d,e,f,g,h){t.call(this,c,d,e),this.uniforms.u_elapsedTime=h||0,this.uniforms.u_teamColor=f||vec4.clone(a),this.uniforms.u_altColor=g||vec4.clone(b)};return f(c,t),c.prototype.setTeamColor=function(a){this.uniforms.u_teamColor=a},c.prototype.setAltColor=function(a){this.uniforms.u_altColor=a},c.prototype.updateTime=function(a){var b=r.prototype.updateTime.call(this,a);return this.uniforms.u_elapsedTime=this.elapsed/1e3%300*.1,b},c}();c.Drawables=c.Drawables||{},c.Drawables.Xm=w;var x=function(){var a=vec4.clone(c.Constants.teamColors.NEUTRAL),b=vec2.fromValues(.5,1.3),d=vec3.fromValues(.5,.5,.5),e=function(c,e,f,g,h,i){t.call(this,c,e,f),this.uniforms.u_color=g||vec4.clone(a),this.uniforms.u_rampTargetInvWidth=h||vec2.clone(b),this.uniforms.u_contributionsAndAlpha=i||vec3.clone(d)};return f(e,t),e.prototype.setColor=function(a){this.uniforms.u_color=a},e.prototype.updateTime=function(a){var b=s.prototype.updateTime.call(this,a),c=this.elapsed/1e4;return this.uniforms.u_rampTargetInvWidth[0]=-2*(c-Math.floor(c))+1,this.uniforms.u_rampTargetInvWidth[1]=2*(c-Math.floor(c)),b},e}();c.Drawables=c.Drawables||{},c.Drawables.ShieldEffect=x;var y=function(){var a=function(a,b){i.call(this,a),this.manifest=b,this.loader=new h,this.textures={},this.meshes={},this.programs={},this.queues={texture:[],mesh:[],program:[]},this.path="/assets/"};f(a,i),a.prototype.handleTexture=function(a,b,c,e,f){if(e)throw this.queues.texture[a]=-1,d.error(e),"Could not load "+b;this.textures[b]=new j(this._gl,c,f),this.queues.texture[a]=1,d.info("loaded texture "+b)},a.prototype.handleMesh=function(a,b,c,e,f){if(e)throw this.queues.mesh[a]=-1,d.error(e),"Could not load "+b;this.meshes[b]=new n(this._gl,f),this.queues.mesh[a]=1,d.info("loaded mesh "+b)},a.prototype.handleProgram=function(a,b,e,f,g){if(f)throw this.queues.program[a]=-1,d.error(f),"Could not load "+b;var h=o;e.program in c.Programs&&(h=c.Programs[e.program]),this.programs[b]=new h(this._gl,g[0],g[1]),this.queues.program[a]=1,d.info("loaded program "+b)},a.prototype.getTexture=function(a){return this.textures[a]},a.prototype.getMesh=function(a){return this.meshes[a]},a.prototype.getProgram=function(a){return this.programs[a]},a.prototype.loadAll=function(){var a,b,c=this.manifest;for(a in c.texture)!c.texture.hasOwnProperty(a)||a in this.textures||(this.textures[a]=null,b=c.texture[a],this.loader.loadAsset(this.path+b.path,"image",this.handleTexture.bind(this,this.queues.texture.length,a,b)),this.queues.texture.push(0));for(a in c.mesh)!c.mesh.hasOwnProperty(a)||a in this.meshes||(this.meshes[a]=null,b=c.mesh[a],this.loader.loadAsset(this.path+b.path,"arraybuffer",this.handleMesh.bind(this,this.queues.mesh.length,a,b)),this.queues.mesh.push(0));for(a in c.program)!c.program.hasOwnProperty(a)||a in this.programs||(this.programs[a]=null,b=c.program[a],this.loader.loadAssetGroup([this.path+b.vertex,this.path+b.fragment],["text","text"],this.handleProgram.bind(this,this.queues.program.length,a,b)),this.queues.program.push(0));return this.getStatus.bind(this)};var b=function(a,b){return 0===b&&a++,a},e=function(a,b){return b>0&&a++,a},g=function(a,b){return 0>b&&a++,a},k=function(a){return{total:a.length,loading:a.reduce(b,0),loaded:a.reduce(e,0),error:a.reduce(g,0)}};return a.prototype.getStatus=function(){return{textures:k(this.queues.texture),meshes:k(this.queues.meshes),programs:k(this.queues.programs)}},a}();c.AssetManager=y;var z=function(){var a=function(a,b){i.call(this,a),this.manager=b,this.entities=[],this.viewProject=mat4.create()};return f(a,i),a.prototype.createDrawable=function(a,b,c,e){var f=this.manager.getTexture(a),g=this.manager.getProgram(b),h=this.manager.getMesh(c);return f?g?h?new e(g,h,f):(d.warn("missing mesh "+c),!1):(d.warn("missing program "+b),!1):(d.warn("missing texture "+a),!1)},a.prototype.addDrawable=function(a){a&&(a.updateView&&a.updateView(this.viewProject),this.entities.push(a))},a.prototype.loadDrawable=function(a,b,c,d){var e=this.createDrawable(a,b,c,d);return this.addDrawable(e),e},a.prototype.addBicoloredDrawable=function(a,b,c){return this.loadDrawable(a,b,c,u)},a.prototype.addXmDrawable=function(a,b,c){return this.loadDrawable(a,b,c,w)},a.prototype.addGlowrampDrawable=function(a,b,c){return this.loadDrawable(a,b,c,v)},a.prototype.addShieldEffectDrawable=function(a,b,c){return this.loadDrawable(a,b,c,x)},a.prototype.updateView=function(a,b){var c,d=this.entities.length;for(mat4.multiply(this.viewProject,b,a),c=0;d>c;c++)this.entities[c].updateView&&this.entities[c].updateView(this.viewProject,a,b)},a.prototype.render=function(){var a,b=this.entities.length;for(a=0;b>a;a++)this.entities[a].draw()},a.prototype.updateTime=function(a){var b,c=this.entities.length;for(b=0;c>b;b++)this.entities[b].updateTime(a)||(this.entities.splice(b,1),b--,c--)},a}();c.Renderers=c.Renderers||{},c.Renderers.Object=z;var A=function(a){var b=a,c=function(a){this.drawables=[],this.renderer=a;for(var c=0;c<b.length;c++)this.drawables.push(b[c].createInstance(a));this.transform=mat4.create()};return c.prototype.add=function(){for(var a=0;a<this.drawables.length;a++)this.renderer.addDrawable(this.drawables[a])},c.prototype.applyTransform=function(){for(var a=0;a<this.drawables.length;a++)this.drawables[a].setMatrix(this.transform)},c.prototype.translate=function(a){mat4.translate(this.transform,this.transform,a),this.applyTransform()},c.prototype.rotate=function(a){var b=mat4.create();mat4.fromQuat(b,a),mat4.multiply(this.transform,this.transform,b),this.applyTransform()},c.prototype.setAnimation=function(a){for(var b=0;b<this.drawables.length;b++)this.drawables[b].onUpdate=a},c};c.Entity=A;var B=function(a,b,c,d){this.texture=a,this.program=b,this.mesh=c,this.baseClass=d};B.prototype.createInstance=function(a){return a.createDrawable(this.texture,this.program,this.mesh,this.baseClass)},c.DrawableSpec=B,c.Primitives=c.Primitives||{},c.Primitives.Inventory=c.Primitives.Inventory||{},c.Primitives.Artifact=c.Primitives.Artifact||{},c.Entities=c.Entities||{},function(){var a=function(a,b,d){var e=new B("FlipCardTexture","bicolor_textured",b,u),f=new B("ObjectXMTexture","xm",d,w);c.Primitives.Inventory[a]=e,c.Primitives.Inventory[a+"Core"]=f,c.Entities[a]=A([e,f])},b=function(a,b,d){var e=d?"Frozen":"",f=a+e+b;c.Primitives.Artifact[f]=new B("Artifact"+a+"Texture","textured",f)},d=function(b,c){a(b,b+"Mesh",b+"X"+(c?"M":"m")+"Mesh")};d("Xmp",!0),d("Resonator",!0),d("Ultrastrike",!0),d("ResShield",!0),d("PowerCube",!1),d("LinkAmp",!1),d("HeatSink",!1),d("MultiHack",!1),d("ForceAmp",!1),d("Turret",!1),d("Capsule",!1),d("ExtraShield",!0),a("FlipCardAda","FlipCardMeshAda","FlipCardXmMesh"),a("FlipCardJarvis","FlipCardMeshJarvis","FlipCardXmMesh");var e={Jarvis:13,Amar:17,Helios:40};for(var f in e)for(var g=0;g<e[f];g++)b(f,g+1,!1),b(f,g+1,!0)}();var C=function(a,b){this.canvas=a;var c=a.getContext("webgl")||a.getContext("experimental-webgl");if(!c)throw"Could not initialize webgl";c.clearColor(0,0,0,1),this.gl=c,this.view=mat4.create(),mat4.lookAt(this.view,[5,5,2],[0,0,0],[0,1,0]),this.project=mat4.create(),this.assetManager=new y(this.gl,b),this.objectRenderer=new z(this.gl,this.assetManager),this.resize(a.width,a.height),this.start=this.last=null,this.paused=!1,this.cleared=!1,this.frame=null};C.prototype.resize=function(a,b){this.gl.viewport(0,0,a,b),mat4.perspective(this.project,45,a/b,.1,100),this.objectRenderer.updateView(this.view,this.project)},C.prototype.stop=function(){this.paused=!0,this.cleared=!1,this.frame&&window.cancelAnimationFrame(this.frame)},C.prototype.render=function(a){if(this.paused)return this.cleared=!0,void(this.paused=!1);var b=0;this.start?(b=a-this.last,this.last=a):(this.start=a,this.last=a);var c=this.gl;c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),c.lineWidth(1),c.enable(c.CULL_FACE),c.frontFace(c.CCW),c.cullFace(c.BACK),c.enable(c.DEPTH_TEST),c.blendEquation(c.FUNC_ADD),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.disable(c.BLEND),c.depthMask(!0),this.objectRenderer.render(),this.frame=window.requestAnimationFrame(this.render.bind(this)),this.objectRenderer.updateTime(b)},C.prototype.preload=function(){this.assetManager.load()},c.Engine=C,c.VERSION="0.12.0",a.IMV=c}(this);
//# sourceMappingURL=ingress-model-viewer.min.js.map